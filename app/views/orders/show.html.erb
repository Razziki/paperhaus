<h1>Order #<%= @order.id %></h1>

<p>
  Placed on <%= @order.created_at.to_s(:long) %><br>
  Ship to: <%= @order.user.address_line1 %>, <%= @order.user.city %>, <%= @order.user.province&.name %>
</p>

<table>
  <thead>
    <tr>
      <th>Product</th>
      <th>Qty</th>
      <th>Unit</th>
      <th>Line total</th>
    </tr>
  </thead>
  <tbody>
    <% @order.order_items.each do |item| %>
      <tr>
        <td><%= item.name_snapshot || item.product&.title %></td>
        <td><%= item.quantity %></td>
        <td><%= number_to_currency(item.unit_price) %></td>
        <td><%= number_to_currency(item.unit_price * item.quantity) %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<p>Subtotal: <%= number_to_currency(@order.subtotal) %></p>
<p>Tax:      <%= number_to_currency(@order.tax_total) %></p>
<p><strong>Total: <%= number_to_currency(@order.grand_total) %></strong></p>
